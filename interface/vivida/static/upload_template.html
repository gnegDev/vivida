{% extends 'layout/base_template.html' %}

{% block styles %}
    <title>Загрузка снимка</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/upload_styles.css') }}">
{% endblock %}

{% block content %}
    <div class="container">
        <h1 class="page-title">Анализ снимка</h1>
        
        <div class="form-container">
            <h2 class="form-title">Данные о снимке</h2>
            <form id="clinicalProfileForm" action="/upload" method="post">
    <!-- Основная информация -->
                <div class="form-section">
                    <h3>Основная информация</h3>

                    <div class="form-group">
                        <label for="stage">Стадия глиобластомы (1-4)</label>
                        <input type="number" id="stage" name="stage" min="1" max="4" placeholder="Введите стадию 1-4" required>
                    </div>

                    <div class="form-group">
                        <label for="age">Возраст пациента</label>
                        <input type="number" id="age" name="age" min="0" max="120" placeholder="Введите возраст" required>
                    </div>

                    <div class="form-group">
                        <label for="gender">Пол пациента</label>
                        <select id="gender" name="gender" required>
                            <option value="">Выберите пол</option>
                            <option value="M">Мужской</option>
                            <option value="F">Женский</option>
                        </select>
                    </div>
                </div>

                <!-- Анамнез и история -->
                <div class="form-section">
                    <h3>Анамнез и история</h3>

                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" name="family_history" value="true">
                            Семейный анамнез опухолей мозга
                        </label>
                    </div>

                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" name="previous_radiation" value="true">
                            Предыдущая лучевая терапия на область головы
                        </label>
                    </div>
                </div>

                <div class="form-section">
                    <h3>Локализация</h3>
                    <div class="form-group">
                        <label for="tumorLocation">Локализация опухоли</label>
                        <select id="tumorLocation" name="tumor_location" required>
                            <option value="">Выберите локализацию</option>
                            <option value="frontal_lobe">Лобная доля</option>
                            <option value="multifocal">Мультифокальная</option>
                            <option value="occipital_lobe">Затылочная доля</option>
                            <option value="parietal_lobe">Теменная доля</option>
                            <option value="temporal_lobe">Височная доля</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="lateralization">Латерализация опухоли</label>
                        <select id="lateralization" name="lateralization" required>
                            <option value="">Выберите латерализацию</option>
                            <option value="LEFT">Левая</option>
                            <option value="RIGHT">Правая</option>
                            <option value="BILATERAL">Двусторонняя</option>
                        </select>
                    </div>
                </div>

                <!-- Молекулярные маркеры -->
                <div class="form-section">
                    <h3>Молекулярные маркеры</h3>

                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" name="mgmt_methylation" value="true">
                            Метилирование промотора MGMT
                        </label>
                    </div>

                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" name="idh_mutation" value="true">
                            Мутация в генах IDH1/IDH2
                        </label>
                    </div>

                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" name="egfr_amplification" value="true">
                            Амплификация EGFR
                        </label>
                    </div>

                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" name="tert_mutation" value="true">
                            Мутация промотора TERT
                        </label>
                    </div>

                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" name="atrx_mutation" value="true">
                            Мутация гена ATRX
                        </label>
                    </div>

                    <div class="form-group">
                        <label for="molecularSubtype">Молекулярный подтип</label>
                        <select id="molecularSubtype" name="molecular_subtype" required>
                            <option value="">Выберите подтип</option>
                            <option value="IDH_MUTANT">IDH мутантный</option>
                            <option value="MGMT_METHYLATED">MGMT метилированный</option>
                            <option value="CLASSICAL">Классический</option>
                        </select>
                    </div>
                </div>

                <!-- Клиническое состояние -->
                <div class="form-section">
                    <h3>Клиническое состояние</h3>

                    <div class="form-group">
                        <label for="kps">Шкала Карновского (KPS)</label>
                        <input type="number" id="kps" name="kps" min="0" max="100" placeholder="0-100" required>
                    </div>

                    <div class="form-group">
                        <label for="neurologicalSymptoms">Неврологические симптомы</label>
                        <textarea id="neurologicalSymptoms" name="neurological_symptoms" placeholder="Введите симптомы через запятую (головная боль, судороги, проблемы с речью...)" required></textarea>
                    </div>
                </div>

                <!-- Лечение -->
                <div class="form-section">
                    <h3>Лечение</h3>

                    <div class="form-group">
                        <label for="steroidDose">Доза стероидов (мг/день)</label>
                        <input type="number" id="steroidDose" name="steroid_dose" step="0.1" min="0" placeholder="Например: 8.0" required>
                    </div>

                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" name="antiseizure_meds" value="true">
                            Прием противоэпилептических препаратов
                        </label>
                    </div>

                    <div class="form-group">
                        <label for="treatment">Тип лечения</label>
                        <select id="treatment" name="treatment" required>
                            <option value="">Выберите тип лечения</option>
                            <option value="chemotherapy">Химиотерапия</option>
                            <option value="radiotherapy">Радиотерапия</option>
                            <option value="chemoradiotherapy">Комбинированный</option>
                        </select>
                    </div>

                    <h3>Заполняется если тип лечения химиотерапия или комбинированный</h3>

                    <div class="form-group">
                        <label for="chemo_drug">Препарат</label>
                        <input type="text" id="chemo_drug" name="chemo_drug" placeholder="Например: Temozolomide">
                    </div>

                    <div class="form-group">
                        <label for="chemo_dose_mg_per_m2">Доза препарата</label>
                        <input type="number" id="chemo_dose_mg_per_m2" name="chemo_dose_mg_per_m2" step="0.1" min="0" placeholder="Например: 75.0">
                    </div>

                    <div class="form-group">
                        <label for="chemo_interval_days">Периодичность приема препарата</label>
                        <input type="number" id="chemo_interval_days" name="chemo_interval_days" min="0" placeholder="Например: 28">
                    </div>

                    <div class="form-group">
                        <label for="chemo_cycles">Число циклов</label>
                        <input type="number" id="chemo_cycles" name="chemo_cycles" min="0" placeholder="Например: 6">
                    </div>

                    <h3>Заполняется если тип лечения радиотерапия или комбинированный</h3>

                    <div class="form-group">
                        <label for="radiation_total_dose_Gy">Полная доза радиации</label>
                        <input type="number" id="radiation_total_dose_Gy" name="radiation_total_dose_Gy" step="0.1" min="0" placeholder="Например: 60.0">
                    </div>

                    <div class="form-group">
                        <label for="radiation_fraction_dose_Gy">Доза фракции</label>
                        <input type="number" id="radiation_fraction_dose_Gy" name="radiation_fraction_dose_Gy" step="0.1" min="0" placeholder="Например: 2.0">
                    </div>

                    <div class="form-group">
                        <label for="radiation_fractions">Число фракций</label>
                        <input type="number" id="radiation_fractions" name="radiation_fractions" min="0" placeholder="Например: 30">
                    </div>


                </div>

                <!-- Визуализация и лечение -->
                <div class="form-section">
                    <h3>Визуализация и лечение</h3>

                    <div class="form-group">
                        <label for="resectionExtent">Объем резекции</label>
                        <select id="resectionExtent" name="resection_extent" required>
                            <option value="">Выберите объем резекции</option>
                            <option value="GROSS_TOTAL">Полная резекция</option>
                            <option value="SUBTOTAL">Субтотальная резекция</option>
                            <option value="BIOPSY_ONLY">Только биопсия</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="tumorSizeBefore">Размер опухоли до лечения (см)</label>
                        <input type="number" id="tumorSizeBefore" name="tumor_size_before" step="0.1" min="0" placeholder="Например: 4.2" required>
                    </div>

                    <div class="form-group">
                        <label for="edemaVolume">Объем перифокального отека (см³)</label>
                        <input type="number" id="edemaVolume" name="edema_volume" step="0.1" min="0" placeholder="Например: 35.5" required>
                    </div>

                    <div class="form-group">
                        <label for="contrastEnhancement">Характер контрастного усиления</label>
                        <select id="contrastEnhancement" name="contrast_enhancement" required>
                            <option value="">Выберите тип усиления</option>
                            <option value="NONE">Отсутствует</option>
                            <option value="PATCHY">Пятнистое</option>
                            <option value="RING">Кольцевидное</option>
                            <option value="SOLID">Солидное</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="functionalStatus">Функциональный статус</label>
                        <select id="functionalStatus" name="functional_status" required>
                            <option value="">Выберите функциональный статус</option>
                            <option value="INDEPENDENT">Самостоятельный</option>
                            <option value="REQUIRES_ASSISTANCE">Требует помощи</option>
                            <option value="FULLY_DEPENDENT">Полностью зависимый</option>
                        </select>
                    </div>
                </div>

                <button type="submit" class="submit-btn">Сохранить клинический профиль</button>
            </form>
        </div>
    </div>
{% endblock %}
